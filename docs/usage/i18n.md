# Translations

Two distinct mechanisms are used depending on what we are handling: 
1)	translation of the terms related to a class;
2)	translation of object fields values (instance).

## Translation of the terms related to a class
Each package might have a folder named ‘i18n’ containing, for each language, a subfolder which name matches the IS0 639 code of the language (ex. : fr_BE or zh_CN). Inside those folders, for each class, is a .json file which prefix is identical to the class it refers to (ex. : Student.json).

Those translation files are in UTF-8 and in JSON format, and contain the translation terms of all items that might be translated (attributes ‘label’ et ‘help’).

This system is not the lighter in terms of overhead but offers the advantage of being usable as is by the UI (no processing server-side).

Indeed, the translation file is directly accessible via HTTP request:
'packages/'+package_name+'/i18n/'+lang+'/'+object_name+'.json',

On the other hand, to obtain the file via script, you have to invoke ?get=core_i18n_lang. 
Location : data/core/i18n/lang.php
URL example: http://localhost/easyobject/?get=core_i18n_lang&class=school\Student&lang=fr

## Translation of objects fields values

All basic fields can be translated (see Fields types).
To allow this, a table in DB is dedicated to the translation terms.
When a field is marked as **multilang**, the values of its translations can be retrieved with a SQL query.
	'Translation' object
	fields:
		string lang (code ISO 639-1)
		string object_class
		string object_field
		integer object_id
		mediumblob value

For the value field, the SQL MEDIUMBLOB type is used (overhead of 3 bytes, max size of 16,7 Mo).

Indeed, the size of the 'value' column may vary greatly from one type to another (the binary type may represent a document, a picture, a video, …). And, most of the time, fields that must be translated are texts (string, short_text or text). In any case, a 3 characters overhead is acceptable (and set a 16 Mo limit should not be a problem).

Note : as the only condition for the SQL type is to be compatible with the associated easyObject type, one must pay attention, in order for a binary field to be translated (for instance a PDF doc available in different languages), that the value of this field never has a greater size to the one of the SQL MEDIUMBLOB type (by example : BLOB, LONGBLOB, …).

#### Using multilang in CRUD

Before anything, the **multilang** field must set to **true** in each Object's field **requiring** a translation. Like so :

```php
'field' => ['type' => 'string', 'multilang' => true]
```

To understand how it works, let's compare with a normal http **UPDATE** controller (which is also valid for CREATE)

```php
<?php
// [...]
MyObject::ids($id)
    	->update($fields)
        ->read(['field1', 'field2'])
        ->adapt('txt')->first();
```

Now let's use the multilang field by adding a parameter in our request

```php
<?php
// [...]
$lang = 'fr';
MyObject::ids($id)
    	->update($fields, $lang)
        ->read(['field1', 'field2'], $lang)
        ->adapt('txt')->first();
```

See what changed?

Adding a "lang" parameter will automatically convert all the multilangs fields to the selected language

> Note: you don't need to specify language for a DELETE request since the whole object gets deleted

And it's the same process for a **GET** request, for instance :

```php
<?php
// [...]
$lang = 'en';
MyObject::search()
    	->read(['field1', 'field2'], $lang)
    	->adapt('txt')->get(true);
```

Now there is a special case you're very likely to encounter : **CREATE** an object with **multiple translations** at once

Here is how you should proceed :

```php
<?php
// [...]
$lang1 = 'fr';
$lang2 = 'en';

MyObject::create($fields, $lang1)
    	->read(['field1', 'field2'])
    	->adapt('txt')->first();

MyObject::ids($id)->update($fields, $lang2);
```

What it does is updating your initial object with the secondary language

If you want to add more than 2 languages, you can repeat that last line for as many languages needed. Like so :

```php
<?php
// [...]
MyObject::ids($id)->update($fields, $lang2); // $lang2 = 'en'
MyObject::ids($id)->update($fields, $lang3); // $lang3 = 'es'
// etc
```

